{"version":3,"file":"bloomreach-ng-sdk.js","sources":["../src/lib/br-container-item-undefined/br-container-item-undefined.component.ts","../src/lib/br-container-box/br-container-box.component.ts","../src/lib/br-container-inline/br-container-inline.component.ts","../src/lib/br-container-ordered-list/br-container-ordered-list.component.ts","../src/lib/br-container-unordered-list/br-container-unordered-list.component.ts","../../src/lib/br-node.directive.ts","../src/lib/br-page/br-page.component.ts","../../src/lib/br-component.directive.ts","../../src/lib/br-meta.directive.ts","../../src/lib/br-manage-content-button.directive.ts","../../src/lib/br-manage-menu-button.directive.ts","../../src/lib/br-node-type.pipe.ts","../../src/lib/br-node-component.directive.ts","../../src/lib/br-node-container.directive.ts","../../src/lib/br-node-container-item.directive.ts","../../src/lib/br-sdk.module.ts","../../src/lib/br-props.model.ts","../../../src/public-api.ts","../../../src/bloomreach-ng-sdk.ts"],"sourcesContent":["/*\n * Copyright 2020 Hippo B.V. (http://www.onehippo.com)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Component, Input } from '@angular/core';\nimport { ContainerItem } from '@bloomreach/spa-sdk';\n\n@Component({\n  selector: 'br-container-item-undefined',\n  templateUrl: './br-container-item-undefined.component.html',\n})\nexport class BrContainerItemUndefinedComponent {\n  @Input() component!: ContainerItem;\n}\n","/*\n * Copyright 2020 Hippo B.V. (http://www.onehippo.com)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ChangeDetectionStrategy, Component, HostBinding, Input } from '@angular/core';\nimport { Container, Page } from '@bloomreach/spa-sdk';\n\n@Component({\n  selector: 'div.br-container-box', // tslint:disable-line: component-selector\n  templateUrl: './br-container-box.component.html',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class BrContainerBoxComponent {\n  @Input() component!: Container;\n  @Input() page!: Page;\n\n  @HostBinding('class.hst-container')\n  get isPreview() {\n    return this.page?.isPreview();\n  }\n}\n","/*\n * Copyright 2020 Hippo B.V. (http://www.onehippo.com)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ChangeDetectionStrategy, Component, HostBinding, Input } from '@angular/core';\nimport { Container, Page } from '@bloomreach/spa-sdk';\n\n@Component({\n  selector: 'div.br-container-inline', // tslint:disable-line: component-selector\n  templateUrl: './br-container-inline.component.html',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class BrContainerInlineComponent {\n  @Input() component!: Container;\n  @Input() page!: Page;\n\n  @HostBinding('class.hst-container')\n  get isPreview() {\n    return this.page?.isPreview();\n  }\n}\n","/*\n * Copyright 2020 Hippo B.V. (http://www.onehippo.com)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ChangeDetectionStrategy, Component, HostBinding, Input } from '@angular/core';\nimport { Container, Page } from '@bloomreach/spa-sdk';\n\n@Component({\n  selector: 'ol.br-container-ordered-list', // tslint:disable-line: component-selector\n  templateUrl: './br-container-ordered-list.component.html',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class BrContainerOrderedListComponent {\n  @Input() component!: Container;\n  @Input() page!: Page;\n\n  @HostBinding('class.hst-container')\n  get isPreview() {\n    return this.page?.isPreview();\n  }\n}\n","/*\n * Copyright 2020 Hippo B.V. (http://www.onehippo.com)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ChangeDetectionStrategy, Component, HostBinding, Input } from '@angular/core';\nimport { Container, Page } from '@bloomreach/spa-sdk';\n\n@Component({\n  selector: 'ul.br-container-unordered-list', // tslint:disable-line: component-selector\n  templateUrl: './br-container-unordered-list.component.html',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class BrContainerUnorderedListComponent {\n  @Input() component!: Container;\n  @Input() page!: Page;\n\n  @HostBinding('class.hst-container')\n  get isPreview() {\n    return this.page?.isPreview();\n  }\n}\n","/*\n * Copyright 2020 Hippo B.V. (http://www.onehippo.com)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Directive, Input, TemplateRef } from '@angular/core';\nimport { Component } from '@bloomreach/spa-sdk';\nimport { BrComponentContext } from './br-component.directive';\n\n@Directive({\n  selector: '[brNode]',\n})\nexport class BrNodeDirective {\n  @Input('brNode') component!: Component;\n  @Input('brNodeTemplate') template?: TemplateRef<BrComponentContext>;\n}\n","/*\n * Copyright 2020 Hippo B.V. (http://www.onehippo.com)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  AfterContentChecked,\n  ChangeDetectorRef,\n  ChangeDetectionStrategy,\n  Component,\n  ContentChild,\n  Inject,\n  Input,\n  NgZone,\n  OnChanges,\n  OnDestroy,\n  Output,\n  Optional,\n  PLATFORM_ID,\n  SimpleChanges,\n  TemplateRef,\n  Type,\n  ViewChild,\n} from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { isPlatformBrowser, isPlatformServer } from '@angular/common';\nimport { makeStateKey, StateKey, TransferState } from '@angular/platform-browser';\nimport { from, of, BehaviorSubject, Subject } from 'rxjs';\nimport { filter, map, mapTo, pairwise, pluck, switchMap, take } from 'rxjs/operators';\nimport { destroy, initialize, isPage, Configuration, Page, PageModel } from '@bloomreach/spa-sdk';\nimport { BrComponentContext } from '../br-component.directive';\nimport { BrProps } from '../br-props.model';\n\ninterface BrNodeContext extends BrComponentContext {\n  template?: TemplateRef<BrComponentContext>;\n}\n\n/**\n * The brXM page.\n */\n@Component({\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  selector: 'br-page',\n  templateUrl: './br-page.component.html',\n})\nexport class BrPageComponent implements AfterContentChecked, OnChanges, OnDestroy {\n  /**\n   * The configuration of the SPA SDK.\n   * @see https://www.npmjs.com/package/@bloomreach/spa-sdk#configuration\n   */\n  @Input() configuration!: Omit<Configuration, 'httpClient'>;\n\n  /**\n   * The brXM and Angular components mapping.\n   */\n  @Input() mapping: Record<string, Type<BrProps>> = {};\n\n  /**\n   * The pre-initialized page instance or prefetched page model.\n   * Mostly this property should be used to transfer state from the server-side to the client-side.\n   */\n  @Input() page?: Page | PageModel;\n\n  /**\n   * The TransferState key is used to transfer the state from the server-side to the client-side.\n   * By default, it equals to `brPage`.\n   * If `false` is passed then the state transferring feature will be disabled.\n   */\n  @Input() stateKey: StateKey<PageModel | undefined> | false = makeStateKey('brPage');\n\n  /**\n   * The current state of the page component.\n   */\n  @Output() state = new BehaviorSubject<Page | undefined>(undefined);\n\n  @ViewChild('brNode', { static: true }) node!: TemplateRef<BrNodeContext>;\n\n  @ContentChild(TemplateRef, { static: true }) private template?: TemplateRef<BrComponentContext>;\n\n  private afterContentChecked$ = new Subject();\n\n  constructor(\n    private changeDetectorRef: ChangeDetectorRef,\n    private httpClient: HttpClient,\n    zone: NgZone,\n    @Inject(PLATFORM_ID) private platform: any,\n    @Optional() private transferState?: TransferState,\n  ) {\n    this.request = this.request.bind(this);\n\n    this.state.pipe(\n      pairwise(),\n      pluck(0),\n      filter(isPage),\n    )\n    .subscribe(destroy);\n\n    this.state.pipe(\n      filter(isPage),\n      switchMap((page) => this.afterContentChecked$.pipe(take(1), mapTo(page))),\n    )\n    .subscribe((page) => zone.runOutsideAngular(() => page.sync()));\n\n    this.state.pipe(\n      filter(() => isPlatformServer(this.platform)),\n      filter(isPage),\n    )\n    .subscribe((page) => this.stateKey && this.transferState?.set(this.stateKey, page.toJSON()));\n  }\n\n  get context(): BrNodeContext | undefined {\n    const page = this.state.getValue();\n    const component = page?.getComponent();\n\n    if (!page || !component) {\n      return;\n    }\n\n    return {\n      component,\n      page,\n      $implicit: component,\n      template: this.template,\n    };\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n    if (changes.configuration || changes.page) {\n      this.initialize(changes.page?.currentValue);\n    }\n\n    if (changes.stateKey?.previousValue && isPlatformServer(this.platform)) {\n      if (changes.stateKey.currentValue && this.transferState?.hasKey(changes.stateKey.previousValue)) {\n        this.transferState?.set(\n          changes.stateKey.currentValue,\n          this.transferState?.get(changes.stateKey.previousValue, undefined),\n        );\n      }\n\n      this.transferState?.remove(changes.stateKey.previousValue);\n    }\n  }\n\n  ngAfterContentChecked(): void {\n    this.afterContentChecked$.next();\n  }\n\n  ngOnDestroy(): void {\n    this.state.next(undefined);\n    this.state.complete();\n    this.afterContentChecked$.complete();\n  }\n\n  private initialize(page: Page | PageModel | undefined): void {\n    if (this.stateKey && isPlatformBrowser(this.platform) && this.transferState?.hasKey(this.stateKey)) {\n      page = page ?? this.transferState?.get(this.stateKey, undefined);\n      this.transferState?.remove(this.stateKey);\n    }\n\n    const configuration = { httpClient: this.request, ...this.configuration } as Configuration;\n    const observable = page\n      ? of(initialize(configuration, page))\n      : from(initialize(configuration));\n\n    observable.subscribe(state => {\n      this.state.next(state);\n      this.changeDetectorRef.detectChanges();\n    });\n  }\n\n  private request(...[{ data: body, headers, method, url }]: Parameters<Configuration['httpClient']>) {\n    return this.httpClient.request<PageModel>(\n      method,\n      url,\n      {\n        body,\n        headers: headers as Record<string, string | string[]>,\n        responseType: 'json'\n      },\n    )\n    .pipe(map(data => ({data})))\n    .toPromise();\n  }\n}\n","/*\n * Copyright 2020 Hippo B.V. (http://www.onehippo.com)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  Directive,\n  Input,\n  OnChanges,\n  OnDestroy,\n  OnInit,\n  Optional,\n  SimpleChanges,\n  TemplateRef,\n  ViewContainerRef,\n} from '@angular/core';\nimport { isComponent, Component, Page } from '@bloomreach/spa-sdk';\nimport { BrNodeDirective } from './br-node.directive';\nimport { BrPageComponent } from './br-page/br-page.component';\n\n/**\n * The template context holding the current brXM Component.\n */\nexport interface BrComponentContext {\n  /**\n   * The implicit value of the context is pointing to the current component.\n   */\n  $implicit: Component;\n\n  /**\n   * The current component.\n   */\n  component: Component;\n\n  /**\n   * The current page.\n   */\n  page: Page;\n}\n\n/**\n * The brXM component.\n */\n@Directive({ selector: '[brComponent]' })\nexport class BrComponentDirective implements OnChanges, OnDestroy, OnInit {\n  /**\n   * The component instance or a path to a component.\n   * The path is defined as a slash-separated components name chain\n   * relative to the current component (e.g. `main/container`).\n   * If it is omitted, all the children will be rendered.\n   */\n  @Input('brComponent') component?: Component | string;\n\n  constructor(\n    private container: ViewContainerRef,\n    @Optional() private template?: TemplateRef<BrComponentContext>,\n    @Optional() private node?: BrNodeDirective,\n    @Optional() private page?: BrPageComponent,\n  ) {}\n\n  ngOnChanges(changes: SimpleChanges): void {\n    if (!changes.component || changes.component.isFirstChange()) {\n      return;\n    }\n\n    this.ngOnDestroy();\n    this.ngOnInit();\n  }\n\n  ngOnDestroy(): void {\n    this.container.clear();\n  }\n\n  ngOnInit(): void {\n    const page = this.page?.state.getValue();\n\n    if (!page) {\n      return;\n    }\n\n    // tslint:disable: no-non-null-assertion\n    this.components?.forEach((component) => this.container.createEmbeddedView(this.page!.node, {\n      component,\n      page,\n      $implicit: component,\n      template: this.template,\n    }));\n    // tslint:enable: no-non-null-assertion\n  }\n\n  private get context(): Component | undefined {\n    if (this.node) {\n      return this.node.component;\n    }\n\n    return this.page?.state.getValue()?.getComponent();\n  }\n\n  private get components(): Component[] | undefined {\n    if (isComponent(this.component)) {\n      return [this.component];\n    }\n\n    if (!this.component) {\n      return this.context?.getChildren();\n    }\n\n    const component = this.context?.getComponent(...this.component.split('/'));\n\n    return component && [component];\n  }\n}\n","/*\n * Copyright 2020 Hippo B.V. (http://www.onehippo.com)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  Directive,\n  OnChanges,\n  OnDestroy,\n  Optional,\n  SimpleChanges,\n  TemplateRef,\n  ViewContainerRef,\n} from '@angular/core';\nimport { MetaCollection } from '@bloomreach/spa-sdk';\n\n@Directive()\nexport abstract class BrMetaDirective implements OnChanges, OnDestroy {\n  protected meta?: MetaCollection | undefined;\n  private clear?: ReturnType<MetaCollection['render']>;\n\n  constructor(\n    private container: ViewContainerRef,\n    @Optional() private template?: TemplateRef<never>,\n  ) {}\n\n  ngOnChanges(changes: SimpleChanges): void {\n    this.clear?.();\n    this.container.clear();\n\n    const { head, tail } = this.render();\n    this.clear = head && tail && this.meta?.render(head, tail);\n  }\n\n  ngOnDestroy(): void {\n    this.clear?.();\n    this.container.clear();\n  }\n\n  private render() {\n    if (!this.template) {\n      return {\n        head: this.container.element.nativeElement,\n        tail: this.container.element.nativeElement,\n      };\n    }\n\n    const embeddedViewRef = this.container.createEmbeddedView(this.template);\n    const [head] = embeddedViewRef.rootNodes;\n    const [tail] = embeddedViewRef.rootNodes.slice(-1);\n\n    return { head, tail };\n  }\n}\n","/*\n * Copyright 2020 Hippo B.V. (http://www.onehippo.com)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Directive, Input, OnChanges, Optional, SimpleChanges, TemplateRef, ViewContainerRef } from '@angular/core';\nimport { ManageContentButton, TYPE_MANAGE_CONTENT_BUTTON } from '@bloomreach/spa-sdk';\nimport { BrMetaDirective } from './br-meta.directive';\nimport { BrPageComponent } from './br-page/br-page.component';\n\n/**\n * The button direcrtive that opens for editing a content.\n */\n@Directive({ selector: '[brManageContentButton]' })\nexport class BrManageContentButtonDirective extends BrMetaDirective implements OnChanges, ManageContentButton {\n  @Input('brManageContentButton') content?: ManageContentButton['content'];\n\n  @Input() documentTemplateQuery?: ManageContentButton['documentTemplateQuery'];\n\n  @Input() folderTemplateQuery?: ManageContentButton['folderTemplateQuery'];\n\n  @Input() path?: ManageContentButton['path'];\n\n  @Input() parameter?: ManageContentButton['parameter'];\n\n  @Input() relative?: ManageContentButton['relative'];\n\n  @Input() root?: ManageContentButton['root'];\n\n  constructor(\n    container: ViewContainerRef,\n    @Optional() template?: TemplateRef<never>,\n    @Optional() private page?: BrPageComponent,\n  ) {\n    super(container, template);\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n    this.meta = this.page?.state.getValue()?.getButton(TYPE_MANAGE_CONTENT_BUTTON, this);\n\n    super.ngOnChanges(changes);\n  }\n}\n","/*\n * Copyright 2020 Hippo B.V. (http://www.onehippo.com)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Directive, Input, OnChanges, Optional, SimpleChanges, TemplateRef, ViewContainerRef } from '@angular/core';\nimport { Menu, TYPE_MANAGE_MENU_BUTTON } from '@bloomreach/spa-sdk';\nimport { BrMetaDirective } from './br-meta.directive';\nimport { BrPageComponent } from './br-page/br-page.component';\n\n/**\n * The button directive that opens a menu editor.\n */\n@Directive({ selector: '[brManageMenuButton]' })\nexport class BrManageMenuButtonDirective extends BrMetaDirective implements OnChanges {\n  /**\n   * The related menu model.\n   */\n  @Input('brManageMenuButton') menu!: Menu;\n\n  constructor(\n    container: ViewContainerRef,\n    @Optional() template?: TemplateRef<never>,\n    @Optional() private page?: BrPageComponent,\n  ) {\n    super(container, template);\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n    this.meta = this.page?.state.getValue()?.getButton(TYPE_MANAGE_MENU_BUTTON, this.menu);\n\n    super.ngOnChanges(changes);\n  }\n}\n","/*\n * Copyright 2020 Hippo B.V. (http://www.onehippo.com)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Pipe, PipeTransform } from '@angular/core';\nimport { isContainer, isContainerItem, Component } from '@bloomreach/spa-sdk';\n\n@Pipe({ name: 'brNodeType' })\nexport class BrNodeTypePipe implements PipeTransform {\n  transform(component: Component): string {\n    if (isContainerItem(component)) {\n      return 'container-item';\n    }\n\n    if (isContainer(component)) {\n      return 'container';\n    }\n\n    return 'component';\n  }\n}\n","/*\n * Copyright 2020 Hippo B.V. (http://www.onehippo.com)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  ComponentFactoryResolver,\n  Directive,\n  Injector,\n  OnChanges,\n  OnDestroy,\n  SimpleChanges,\n  Type,\n  ViewContainerRef,\n} from '@angular/core';\nimport { Component, MetaCollection } from '@bloomreach/spa-sdk';\nimport { BrNodeDirective } from './br-node.directive';\nimport { BrPageComponent } from './br-page/br-page.component';\nimport { BrProps } from './br-props.model';\n\n@Directive({\n  selector: '[brNodeComponent]',\n  inputs: [ 'component:brNodeComponent' ], // tslint:disable-line: no-inputs-metadata-property\n})\nexport class BrNodeComponentDirective<T extends Component> implements OnChanges, OnDestroy {\n  component!: T;\n\n  private clear?: ReturnType<MetaCollection['render']>;\n\n  constructor(\n    private container: ViewContainerRef,\n    private injector: Injector,\n    private componentFactoryResolver: ComponentFactoryResolver,\n    private node: BrNodeDirective,\n    protected page: BrPageComponent,\n  ) {}\n\n  ngOnChanges(changes: SimpleChanges): void {\n    this.clear?.();\n    this.container.clear();\n\n    const { head, tail } = this.render();\n\n    this.clear = head && tail && this.component.getMeta().render(head, tail);\n  }\n\n  protected getMapping(): Type<BrProps> | undefined {\n    return this.page.mapping[this.component.getName()];\n  }\n\n  private render() {\n    if (this.node.template) {\n      return this.renderTemplate();\n    }\n\n    const component = this.getMapping();\n    if (!component) {\n      return this.renderChildren();\n    }\n\n    return this.renderMapping(component);\n  }\n\n  private renderTemplate() {\n    // tslint:disable: no-non-null-assertion\n    const embeddedViewRef = this.container.createEmbeddedView(this.node.template!, {\n      $implicit: this.component,\n      component: this.component,\n      page: this.page.state.getValue()!,\n    });\n    // tslint:enable: no-non-null-assertion\n    const [head] = embeddedViewRef.rootNodes;\n    const [tail] = embeddedViewRef.rootNodes.slice(-1);\n\n    return { head, tail };\n  }\n\n  private renderChildren() {\n    const nodes = this.component.getChildren()\n      .map(component => this.container.createEmbeddedView(this.page.node, {\n        component,\n        $implicit: component,\n        page: this.page.state.getValue()!, // tslint:disable-line: no-non-null-assertion\n      }))\n      .flatMap(view => view.rootNodes);\n\n    const head = nodes[0] ?? this.container.element.nativeElement;\n    const tail = nodes[nodes.length - 1] ?? head;\n\n    return { head, tail };\n  }\n\n  private renderMapping(component: Type<BrProps>) {\n    const componentFactory = this.componentFactoryResolver.resolveComponentFactory(component);\n    const componentRef = this.container.createComponent(componentFactory, undefined, this.injector);\n\n    componentRef.instance.component = this.component;\n    componentRef.instance.page = this.page.state.getValue();\n\n    return {\n      head: componentRef.location.nativeElement,\n      tail: componentRef.location.nativeElement,\n    };\n  }\n\n  ngOnDestroy(): void {\n    this.clear?.();\n    this.container.clear();\n  }\n}\n","/*\n * Copyright 2020 Hippo B.V. (http://www.onehippo.com)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Directive, Type } from '@angular/core';\nimport {\n  Container,\n  TYPE_CONTAINER_INLINE,\n  TYPE_CONTAINER_NO_MARKUP,\n  TYPE_CONTAINER_ORDERED_LIST,\n  TYPE_CONTAINER_UNORDERED_LIST,\n} from '@bloomreach/spa-sdk';\nimport { BrContainerBoxComponent } from './br-container-box/br-container-box.component';\nimport { BrContainerInlineComponent } from './br-container-inline/br-container-inline.component';\nimport { BrContainerOrderedListComponent } from './br-container-ordered-list/br-container-ordered-list.component';\nimport {\n  BrContainerUnorderedListComponent,\n} from './br-container-unordered-list/br-container-unordered-list.component';\nimport { BrNodeComponentDirective } from './br-node-component.directive';\nimport { BrProps } from './br-props.model';\n\n@Directive({\n  selector: '[brNodeContainer]',\n  inputs: [ 'component:brNodeContainer' ], // tslint:disable-line: no-inputs-metadata-property\n})\nexport class BrNodeContainerDirective extends BrNodeComponentDirective<Container> {\n  protected getMapping(): Type<BrProps> | undefined {\n    const type = this.component.getType();\n\n    if (type && type in this.page.mapping) {\n      return this.page.mapping[type];\n    }\n\n    switch (type) {\n      case TYPE_CONTAINER_INLINE: return BrContainerInlineComponent;\n      case TYPE_CONTAINER_ORDERED_LIST: return BrContainerOrderedListComponent;\n      case TYPE_CONTAINER_UNORDERED_LIST: return BrContainerUnorderedListComponent;\n      case TYPE_CONTAINER_NO_MARKUP: return;\n      default: return BrContainerBoxComponent;\n    }\n  }\n}\n","/*\n * Copyright 2020 Hippo B.V. (http://www.onehippo.com)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  ChangeDetectorRef,\n  ComponentFactoryResolver,\n  Directive,\n  Injector,\n  OnChanges,\n  OnDestroy,\n  SimpleChanges,\n  Type,\n  ViewContainerRef,\n} from '@angular/core';\nimport { ContainerItem } from '@bloomreach/spa-sdk';\nimport {\n  BrContainerItemUndefinedComponent,\n} from './br-container-item-undefined/br-container-item-undefined.component';\nimport { BrNodeComponentDirective } from './br-node-component.directive';\nimport { BrNodeDirective } from './br-node.directive';\nimport { BrPageComponent } from './br-page/br-page.component';\nimport { BrProps } from './br-props.model';\n\n@Directive({\n  selector: '[brNodeContainerItem]',\n  inputs: [ 'component:brNodeContainerItem' ], // tslint:disable-line: no-inputs-metadata-property\n})\nexport class BrNodeContainerItemDirective\nextends BrNodeComponentDirective<ContainerItem>\nimplements OnChanges, OnDestroy {\n  constructor(\n    container: ViewContainerRef,\n    injector: Injector,\n    componentFactoryResolver: ComponentFactoryResolver,\n    node: BrNodeDirective,\n    page: BrPageComponent,\n    private changeDetectorRef: ChangeDetectorRef,\n  ) {\n    super(container, injector, componentFactoryResolver, node, page);\n\n    this.onUpdate = this.onUpdate.bind(this);\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n    changes.component?.previousValue?.off('update', this.onUpdate);\n\n    super.ngOnChanges(changes);\n\n    this.component.on('update', this.onUpdate);\n  }\n\n  ngOnDestroy(): void {\n    this.component.off('update', this.onUpdate);\n  }\n\n  private onUpdate(): void {\n    this.changeDetectorRef.markForCheck();\n    this.page.state.getValue()?.sync();\n  }\n\n  protected getMapping(): Type<BrProps> | undefined {\n    const type = this.component.getType();\n\n    if (type && type in this.page.mapping) {\n      return this.page.mapping[type];\n    }\n\n    return BrContainerItemUndefinedComponent;\n  }\n}\n","/*\n * Copyright 2020 Hippo B.V. (http://www.onehippo.com)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { CommonModule } from '@angular/common';\nimport { HttpClientModule } from '@angular/common/http';\nimport { NgModule } from '@angular/core';\n\nimport { BrContainerItemUndefinedComponent } from './br-container-item-undefined/br-container-item-undefined.component';\nimport { BrContainerBoxComponent } from './br-container-box/br-container-box.component';\nimport { BrContainerInlineComponent } from './br-container-inline/br-container-inline.component';\nimport { BrContainerOrderedListComponent } from './br-container-ordered-list/br-container-ordered-list.component';\nimport {\n  BrContainerUnorderedListComponent,\n} from './br-container-unordered-list/br-container-unordered-list.component';\nimport { BrComponentDirective } from './br-component.directive';\nimport { BrManageContentButtonDirective } from './br-manage-content-button.directive';\nimport { BrManageMenuButtonDirective } from './br-manage-menu-button.directive';\nimport { BrNodeTypePipe } from './br-node-type.pipe';\nimport { BrNodeComponentDirective } from './br-node-component.directive';\nimport { BrNodeContainerDirective } from './br-node-container.directive';\nimport { BrNodeContainerItemDirective } from './br-node-container-item.directive';\nimport { BrNodeDirective } from './br-node.directive';\nimport { BrPageComponent } from './br-page/br-page.component';\n\n@NgModule({\n  declarations: [\n    BrComponentDirective,\n    BrContainerBoxComponent,\n    BrContainerInlineComponent,\n    BrContainerOrderedListComponent,\n    BrContainerUnorderedListComponent,\n    BrContainerItemUndefinedComponent,\n    BrManageContentButtonDirective,\n    BrManageMenuButtonDirective,\n    BrNodeComponentDirective,\n    BrNodeContainerDirective,\n    BrNodeContainerItemDirective,\n    BrNodeDirective,\n    BrNodeTypePipe,\n    BrPageComponent,\n  ],\n  entryComponents: [\n    BrContainerBoxComponent,\n    BrContainerInlineComponent,\n    BrContainerOrderedListComponent,\n    BrContainerUnorderedListComponent,\n    BrContainerItemUndefinedComponent,\n  ],\n  exports: [\n    BrComponentDirective,\n    BrManageContentButtonDirective,\n    BrManageMenuButtonDirective,\n    BrPageComponent,\n  ],\n  imports: [ CommonModule, HttpClientModule ],\n})\nexport class BrSdkModule { }\n","/*\n * Copyright 2020 Hippo B.V. (http://www.onehippo.com)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Component, Page } from '@bloomreach/spa-sdk';\n\n/**\n * The mapped component properties.\n */\nexport interface BrProps<T extends Component = Component> {\n  /**\n   * The mapped component.\n   */\n  component?: T;\n\n  /**\n   * The current page.\n   */\n  page?: Page;\n}\n","/*\n * Copyright 2020 Hippo B.V. (http://www.onehippo.com)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport * from './lib/br-sdk.module';\nexport * from './lib/br-component.directive';\nexport * from './lib/br-manage-content-button.directive';\nexport * from './lib/br-manage-menu-button.directive';\nexport * from './lib/br-page/br-page.component';\nexport * from './lib/br-props.model';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n\nexport {BrContainerBoxComponent as ɵb} from './lib/br-container-box/br-container-box.component';\nexport {BrContainerInlineComponent as ɵc} from './lib/br-container-inline/br-container-inline.component';\nexport {BrContainerItemUndefinedComponent as ɵf} from './lib/br-container-item-undefined/br-container-item-undefined.component';\nexport {BrContainerOrderedListComponent as ɵd} from './lib/br-container-ordered-list/br-container-ordered-list.component';\nexport {BrContainerUnorderedListComponent as ɵe} from './lib/br-container-unordered-list/br-container-unordered-list.component';\nexport {BrMetaDirective as ɵg} from './lib/br-meta.directive';\nexport {BrNodeComponentDirective as ɵh} from './lib/br-node-component.directive';\nexport {BrNodeContainerItemDirective as ɵj} from './lib/br-node-container-item.directive';\nexport {BrNodeContainerDirective as ɵi} from './lib/br-node-container.directive';\nexport {BrNodeTypePipe as ɵk} from './lib/br-node-type.pipe';\nexport {BrNodeDirective as ɵa} from './lib/br-node.directive';"],"names":[],"mappings":"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"}